/*! dragee 16-11-2016 */
function XmlHttpRequest(){return window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:window.ActiveXObject&&(xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")),null==xmlhttp&&alert("Your browser does not support XMLHTTP."),xmlhttp}!function(a){"use strict";function b(a){if(a){if("string"==typeof d[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var b,e=0,f=c.length;f>e;e++)if(b=c[e]+a,"string"==typeof d[b])return b}}var c="Webkit Moz ms Ms O".split(" "),d=document.documentElement.style;"function"==typeof define&&define.amd?define(function(){return b}):"object"==typeof exports?module.exports=b:a.getStyleProperty=b}(window),function(){"use strict";var a,b=window.Dragee||{};a={getDefaultParent:function(a){for(var b=a.parentNode;b.parentNode&&"static"===window.getComputedStyle(b).position;)b=b.parentNode;return b},bind:function(a,b){return function(){return a.apply(b,[].splice.call(arguments,0))}},getTouchByID:function(a,b){var c;for(c=0;c<a.changedTouches.length;c++)if(a.changedTouches[c].identifier===b)return a.changedTouches[c];return!1},getSumValueOfStyleRule:function(a,b){return b.reduce(function(b,c){return b+parseInt(window.getComputedStyle(a)[c]||0)},0)},appendFirstChild:function(a,b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)},range:function(a,b,c){var d=[];if("undefined"==typeof b&&(b=a,a=0),"undefined"==typeof c&&(c=1),c>0&&a>=b||0>c&&b>=a)return[];for(var e=a;c>0?b>e:e>b;e+=c)d.push(e);return d},setStyle:function(a,b){b=b||{};var c,d="";for(c in b)b.hasOwnProperty(c)&&(d+=c+": "+b[c]+"; ");a.style.cssText=d},randomColor:function(){var a=function(){return Math.round(255*Math.random())},b=function(a){for(var b=a.toString(16);b.length<2;)b="0"+b;return b},c=a(),d=a(),e=a();return"#"+b(c)+b(d)+b(e)},createCanvas:function(b,c){var d;return"static"===window.getComputedStyle(b).position&&(b.style.position="relative"),d=document.createElement("canvas"),d.setAttribute("width",c.size.x+"px"),d.setAttribute("height",c.size.y+"px"),a.setStyle(d,{position:"absolute",left:c.position.y+"px",top:c.position.y+"px",width:c.size.x+"px",height:c.size.y+"px"}),a.appendFirstChild(b,d),d}},b.util=a,window.Dragee=b}(),function(){"use strict";function a(a,b){b=b||{},this.funcs=[],this.context=a,this.isReverse=b.isReverse||!1,this.isStopOnTrue=b.isStopOnTrue||!1}var b=window.Dragee||{};a.prototype.fire=function(){var a,b,c=[].slice.call(arguments),d=this.isReverse?this.funcs.slice().reverse():this.funcs;for(a=0;a<d.length;a++)if(b=d[a].apply(this.context,c),this.isStopOnTrue&&b)return!0;return!this.isStopOnTrue},a.prototype.add=function(a){this.funcs.push(a)},a.prototype.unshift=function(a){this.funcs.unshift(a)},a.prototype.remove=function(a){var b=this.funcs.indexOf(a);-1!==b&&funcs.splice(b,1)},a.prototype.reset=function(a){this.funcs=[]},b.Event=a,window.Dragee=b}(),clone=function(a){function b(a){for(var b in a)this[b]=a[b]}return new b(a)},Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=arguments[1],e=0;c>e;e++)e in b&&a.call(d,b[e],e,b)}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.every||(Array.prototype.every=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=arguments[1],e=0;c>e;e++)if(e in b&&!a.call(d,b[e],e,b))return!1;return!0}),Array.prototype.map||(Array.prototype.map=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=new Array(c),e=arguments[1],f=0;c>f;f++)f in b&&(d[f]=a.call(e,b[f],f,b));return d}),Array.prototype.some||(Array.prototype.some=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=arguments[1],e=0;c>e;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1}),Array.prototype.removeItem||(Array.prototype.removeItem=function(a){for(var b=0;b<this.length;b++)this[b]===a&&(this.splice(b,1),b--);return this}),Element.prototype.hasClass=function(a){var b=new RegExp("(^|\\s)"+a+"(\\s|$)","g");return b.test(this.className)},Element.prototype.addClass=function(a){return this.hasClass(a)?this:(this.className=(this.className+" "+a).replace(/\s+/g," ").replace(/(^ | $)/g,""),this)},Element.prototype.removeClass=function(a){var b=new RegExp("(^|\\s)"+a+"(\\s|$)","g");return this.className=this.className.replace(b,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,""),this},HTMLElement.prototype.appbeginChild=function(a){this.firstChild?this.insertBefore(a,this.firstChild):this.appendChild(a)},HTMLElement.prototype.exchange=function(a){var b=a.parentNode,c=a.nextElementSibling;return this.parentNode.insertBefore(a,this),c?b.insertBefore(this,c):b.appendChild(this),a};var fullOffset=function(a,b,c){for(var d=0;a&&a.id!=c;)"x"==b&&a.offsetLeft&&(d+=a.offsetLeft),"y"==b&&a.offsetTop&&(d+=a.offsetTop),a=a.parentNode;return d},extend=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype},augment=function(a,b){if(arguments[2])for(var c=2,d=arguments.length;d>c;c++)a.prototype[arguments[c]]=b.prototype[arguments[c]];else for(methodName in b.prototype)a.prototype[methodName]||(a.prototype[methodName]=b.prototype[methodName])};augment(NodeList,Array,"forEach"),Math.getNearIndex=function(a,b){for(var c=Math.abs(a[0]-b),d=0,e=0;e<a.length;e++){var f=Math.abs(a[e]-b);c>f&&(c=f,d=e)}return d},Math.getNearIndexWithCaptureRadius=function(a,b,c){for(var d=Math.abs(a[0]-c),e=0,f=0;f<a.length;f++){var g=Math.abs(a[f]-c);d>g&&(d=g,e=f)}return d>b?-1:e},Math.bound=function(a,b,c){return Math.max(a,Math.min(b,c))},Math.boundPoint=function(a,b,c){var d=Math.max(a.x,Math.min(b.x,c.x)),e=Math.max(a.y,Math.min(b.y,c.y));return new Point(d,e)},Math.getLength=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},Math.toRadian=function(a){return a%361*Math.PI/180},String.prototype.substrend=function(a){return this.substr(0,this.length-a)},window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1e3/60)}}();try{!Object.prototype.__defineGetter__&&Object.defineProperty({},"x",{get:function(){return!0}}).x&&(Object.defineProperty(Object.prototype,"__defineGetter__",{enumerable:!1,configurable:!0,value:function(a,b){Object.defineProperty(this,a,{get:b,enumerable:!0,configurable:!0})}}),Object.defineProperty(Object.prototype,"__defineSetter__",{enumerable:!1,configurable:!0,value:function(a,b){Object.defineProperty(this,a,{set:b,enumerable:!0,configurable:!0})}}))}catch(defPropException){}!function(){"use strict";function a(a,b){this.x=a,this.y=b}function b(a,b){this.position=a,this.size=b}var c;a.prototype.toString=function(){return"{x="+this.x+",y="+this.y+"}"},a.prototype.add=function(b){return new a(this.x+b.x,this.y+b.y)},a.prototype.sub=function(b){return new a(this.x-b.x,this.y-b.y)},a.prototype.mult=function(b){return new a(this.x*b,this.y*b)},a.prototype.negative=function(){return new a(-this.x,-this.y)},a.prototype.compare=function(a){return this.x===a.x&&this.y===a.y},a.prototype.clone=function(){return new a(this.x,this.y)},b.prototype.getP1=function(){return this.position},b.prototype.getP2=function(){return new a(this.position.x+this.size.x,this.position.y)},b.prototype.getP3=function(){return this.position.add(this.size)},b.prototype.getP4=function(){return new a(this.position.x,this.position.y+this.size.y)},b.prototype.getCenter=function(){return this.position.add(this.size.mult(.5))},b.prototype.or=function(c){var d=new a(Math.min(this.position.x,c.position.x),Math.min(this.position.y,c.position.y)),e=new a(Math.max(this.position.x+this.size.x,c.position.x+c.size.x),Math.max(this.position.y+this.size.y,c.position.y+c.size.y)).sub(d);return new b(d,e)},b.prototype.and=function(c){var d=new a(Math.max(this.position.x,c.position.x),Math.max(this.position.y,c.position.y)),e=new a(Math.min(this.position.x+this.size.x,c.position.x+c.size.x),Math.min(this.position.y+this.size.y,c.position.y+c.size.y)).sub(d);return e.x<=0||e.y<=0?null:new b(d,e)},b.prototype.includePoint=function(a){return!(this.position.x>a.x||this.position.x+this.size.x<a.x||this.position.y>a.y||this.position.y+this.size.y<a.y)},b.prototype.includeRectangle=function(a){return this.includePoint(a.position)&&this.includePoint(a.getP3())},b.prototype.moveToBound=function(a,b){var c,d,e,f,g,h;if(b)c=b;else{if(d=this.and(a),!d)return a;c=d.size.x>d.size.y?"y":"x"}return e=this.getCenter(),f=a.getCenter(),g=e[c]>f[c]?-1:1,h=g>0?this.position[c]+this.size[c]-a.position[c]:this.position[c]-(a.position[c]+a.size[c]),a.position[c]=a.position[c]+h,a},b.prototype.getSquare=function(){return this.size.x*this.size.y},b.prototype.styleApply=function(a){a=a||document.querySelector("ind"),a.style.left=this.position.x+"px",a.style.top=this.position.y+"px",a.style.width=this.size.x+"px",a.style.height=this.size.y+"px"},b.prototype.growth=function(a){this.size=this.size.add(a),this.position=this.position.add(a.mult(-.5))},b.prototype.getMinSide=function(){return Math.min(this.size.x,this.size.y)},c={getLength:function(a){return!a||a.x&&a.y&&!a.isTransformationSpace?function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}:a.x&&a.y&&a.isTransformationSpace?function(b,c){return Math.sqrt(Math.pow(a.x*Math.abs(b.x-c.x),2)+Math.pow(a.y*Math.abs(b.y-c.y),2))}:a.x?function(a,b){return Math.abs(a.x-b.x)}:a.y?function(a,b){return Math.abs(a.y-b.y)}:void 0},indexOfNearPoint:function(a,b,c,d){var e,f,g,h=0;if(d=d||this.getLength(),0===a.length)return-1;for(e=d(a[0],b),f=0;f<a.length;f++)g=d(a[f],b),e>g&&(e=g,h=f);return c>=0&&e>c?-1:h},bound:function(a,b,c){return Math.max(a,Math.min(b,c))},boundPoint:function(b,c,d){var e=Math.max(b.x,Math.min(c.x,d.x)),f=Math.max(b.y,Math.min(c.y,d.y));return new a(e,f)},directCrossing:function(b,c,d,e){var f,g,h,i,j,k,l;return d.x===e.x&&(f=d,d=b,b=f,f=e,e=c,c=f),b.x===c.x?(h=(e.y-d.y)/(e.x-d.x),j=(e.x*d.y-d.x*e.y)/(e.x-d.x),k=b.x,l=k*h+j,new a(k,l)):(g=(c.y-b.y)/(c.x-b.x),i=(c.x*b.y-b.x*c.y)/(c.x-b.x),h=(e.y-d.y)/(e.x-d.x),j=(e.x*d.y-d.x*e.y)/(e.x-d.x),k=(i-j)/(h-g),l=k*g+i,new a(k,l))},boundOnSegment:function(b,d,e){var f,g;return f=c.bound(Math.min(b.x,d.x),Math.max(b.x,d.x),e.x),f!=e.x&&(g=f===b.x?b.y:d.y,e=new a(f,g)),g=c.bound(Math.min(b.y,d.y),Math.max(b.y,d.y),e.y),g!=e.y&&(f=g===b.y?b.x:d.x,e=new a(f,g)),e},boundOnLine:function(b,c,d){var e=new a(d.x-b.x,d.y-b.y),f=new a(c.x-b.x,c.y-b.y),g=f.x*f.x+f.y*f.y,h=e.x*f.x+e.y*f.y,i=h/g;return new a(b.x+f.x*i,b.y+f.y*i)},getPointInLine:function(b,c,d){var e=c.x-b.x,f=c.y-b.y;return new a(b.x+d*e,b.y+d*f)},getPointInLineByLenght:function(b,c,d){var e=c.x-b.x,f=c.y-b.y,g=d/this.getLength()(b,c);return new a(b.x+g*e,b.y+g*f)},createRectangleFromElement:function(a,c,d,e){var f=this.getSizeOfElement(a,d);return new b(this.getOffset(a,c||a.parentNode,e),f)},getSizeOfElement:function(b,c){var d=parseInt(window.getComputedStyle(b).width),e=parseInt(window.getComputedStyle(b).height);return c||(d+=Dragee.util.getSumValueOfStyleRule(b,["padding-left","padding-right","border-left-width","border-right-width"]),e+=Dragee.util.getSumValueOfStyleRule(b,["padding-top","padding-bottom","border-top-width","border-bottom-width"])),new a(d,e)},getOffset:function(b,c,d){var e=b.getBoundingClientRect(),f=c.getBoundingClientRect();return new a(e.left-f.left,e.top-f.top)},getPointFromRadialSystem:function(b,c,d){return d=d||new a(0,0),d.add(new a(c*Math.cos(b),c*Math.sin(b)))},addPointToBoundPoints:function(a,b,c){var d,e=a.filter(function(a){return a.y>b.y||(c?a.x<b.x:a.x>b.x)});for(d=0;d<e.length;d++)if(b.y<e[d].y)return e.splice(d,0,b),e;return e.push(b),e},getAngle:function(a,b){var c=b.sub(a);return this.normalizeAngle(Math.atan2(c.y,c.x))},toRadian:function(a){return a%360*Math.PI/180},toDegree:function(a){return 180*a/Math.PI%360},boundAngle:function(a,b,c){var d,e;return b>a&&c>a&&b>c?c:a>b&&(b>c||c>a)?c:(d=this.getAngleDiff(a,c),e=this.getAngleDiff(b,c),e>d?a:b)},getNearestAngle:function(a,b){var d,e,f,g=2*Math.PI;for(d=0;d<a.length;d++)e=c.getAngleDiff(a[d],b),e>g&&(g=e,f=a[d]);return f},getAngleDiff:function(a,b){var c=Math.min(a,b),d=Math.max(a,b);return Math.min(d-c,c+2*Math.PI-d)},normalizeAngle:function(a){for(;0>a;)a+=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;return a},distance:function(a,b){var c=0,d=0;return c=b.x-a.x,c*=c,d=b.y-a.y,d*=d,Math.sqrt(c+d)}},window.Point=a,window.Rectangle=b,window.mathPoint=c}(),function(){"use strict";function a(b){switch(b){case c.element:return function(b,d){var e,f=function(){return e.apply(this,arguments)};return f.refresh=function(){e=a(c.rectangle)(mathPoint.createRectangleFromElement(b,d))},f.refresh(),f};case c.rectangle:return function(a){return function(b,c){var d=b.clone(),e=a.getP3();return a.position.x>d.x&&(d.x=a.position.x),a.position.y>d.y&&(d.y=a.position.y),e.x<d.x+c.x&&(d.x=e.x-c.x),e.y<d.y+c.y&&(d.y=e.y-c.y),d}};case c.lineX:return function(a,b,c){return function(d,e){var f=d.clone();return f.x=a,b>f.y&&(f.y=b),c<f.y+e.y&&(f.y=c-e.y),f}};case c.lineY:return function(a,b,c){return function(d,e){var f=d.clone();return f.y=a,b>f.x&&(f.x=b),c<f.x+e.x&&(f.x=c-e.x),f}};case c.line:return function(a,b){var c=Math.atan2(b.y-a.y,b.x-a.x),d=c+Math.PI/2,e=10,f=Math.cos(d),g=Math.sin(d);return function(c,d){var h=new Point(c.x+e*f,c.y+e*g),i=mathPoint.directCrossing(a,b,c,h),j=mathPoint.getPointInLineByLenght(b,a,d.x);return i=mathPoint.boundOnLine(a,j,i)}};case c.circle:return function(a,b){return function(c,d){var e=mathPoint.getPointInLineByLenght(a,c,b);return e}};case c.arc:return function(a,b,c,d){return function(e,f){var g="function"==typeof c?c():c,h="function"==typeof c?d():d,i=mathPoint.getAngle(a,e);return i=mathPoint.normalizeAngle(i),i=mathPoint.boundAngle(g,h,i),mathPoint.getPointFromRadialSystem(i,b,a)}}}}var b=window.Dragee||{},c={element:-1,rectangle:0,lineX:1,lineY:2,line:3,unificationOfRectangle:4,circle:5,arc:6};b.boundType=c,b.boundFactory=a,window.Dragee=b}(),function(){"use strict";function a(a){switch(a){case d.notCrossing:return function(a,b){var c,d={removable:!0};for(c in b)d[c]=b[c];return function(b,c){var d="function"==typeof a?a():a,e=b.reduce(function(a,b,d){return-1===c.indexOf(d)&&a.push(d),a},[]);return c.forEach(function(a){var c=b[a],f=!1;e.forEach(function(a){var d=b[a];c=d.moveToBound(c)}),f=e.some(function(a){var d=b[a];return!!d.and(c)})||c.and(d).getSquare()!==c.getSquare(),f?c.removable=!0:e.push(a)}),b}};case d.floatLeft:return function(a,b){var c,d={paddingTopLeft:new Point(0,0),paddingBottomRight:new Point(0,0),yGapBetweenDraggables:0,removable:!0};for(c in b)d[c]=b[c];return function(b,c){var e,f="function"==typeof a?a():a,g=f.getP2(),h=[f.position];return b.forEach(function(a,b){var c,i=!1;for(e=0;e<h.length&&(c=new Point(h[e].x,e>0?h[e-1].y+d.yGapBetweenDraggables:f.position.y).add(d.paddingTopLeft),!(i=c.x+a.size.x<g.x));e++);i||(c=new Point(f.position.x,h[h.length-1].y+d.yGapBetweenDraggables).add(d.paddingTopLeft)),a.position=c,d.removable&&a.getP3().y>f.getP3().y&&(a.removable=!0),h=mathPoint.addPointToBoundPoints(h,a.getP3().add(d.paddingBottomRight))}),b}};case d.floatRight:return function(a,b){var c,d,e,f={paddingTopRight:new Point(5,5),paddingBottomLeft:new Point(0,0),removable:!0};for(e in b)f[e]=b[e];return c=new Point(-f.paddingTopRight.x,f.paddingTopRight.y),d=new Point(-f.paddingBottomLeft.x,f.paddingBottomLeft.y),function(b,e){var g,h="function"==typeof a?a():a,i=[h.getRightTopPoint()];return b.forEach(function(a,b){var e,j=!1;for(g=0;g<i.length&&(e=new Point(i[g].x-a.size.x,g>0?i[g-1].y:h.position.y).add(c),!(j=e.x>a.position.x));g++);j||(e=new Point(h.getP2().x,i[i.length-1].y)),a.position=e,f.removable&&a.getLeftBottomPoint().y>h.getP4().y&&(a.removable=!0),i=mathPoint.addPointToBoundPoints(i,a.getP4().add(d),!0)}),b}}}}function b(a){switch(a){case d.notCrossing:return function(){return function(a,b,c){var d=a.concat(b);return b.forEach(function(a){c.push(d.indexOf(a))}),d}};case d.floatLeft:case d.floatRight:return function(a,b,c){var d,e={getPosition:function(a){return a.position}};for(d in c)e[d]=c[d];return function(c,d,f){var g,h=c.concat();return g=c.map(e.getPosition),d.forEach(function(d){var f=mathPoint.indexOfNearPoint(g,e.getPosition(d),a,b);f=-1===f?h.length:h.indexOf(c[f]),h.splice(f,0,d)}),d.forEach(function(a){f.push(h.indexOf(a))}),h}}}}var c=window.Dragee||{},d={notCrossing:0,floatLeft:1,floatRight:2};c.positionType=d,c.sortingFactory=b,c.positionFactory=a,window.Dragee=c}(),function(){"use strict";function a(a,c){c=c||{};var d,e=this,f=c.parent||b.util.getDefaultParent(a);this.options={parent:f,bound:b.boundFactory(b.boundType.element)(f,f),startFilter:!1,isContentBoxSize:!1,position:!1};for(d in c)c.hasOwnProperty(d)&&(this.options[d]=c[d]);this.onEnd=new b.Event(this,{isReverse:!0,isStopOnTrue:!0}),this.onMove=new b.Event(this),this.onStart=new b.Event(this),this.onEnd.add(function(){this.move(this.position,0,!0,!0)}),c.onEnd&&this.onEnd.add(c.onEnd),c.onMove&&this.onMove.add(c.onMove),c.onStart&&this.onStart.add(c.onStart),this.element=a,this.bound=this.options.bound,h(this),e.init()}var b=window.Dragee||{},c="ontouchstart"in window,d={start:"mousedown",move:"mousemove",end:"mouseup"},e={start:"touchstart",move:"touchmove",end:"touchend"},f=c?e:d,g=[],h=function(a){var b="for this element Dragee.Draggable is already exist, don't create it twice ";if(g.some(function(b){return a.element===b.element}))throw b;g.push(a)},i=getStyleProperty("transform"),j=getStyleProperty("transition");b.events=f,a.prototype.init=function(){this._enable=!0,this.offset=mathPoint.getOffset(this.element,this.options.parent,!0),this.fixPosition=this.offset,this.position=this.offset,this.options.position?(this.initPosition=this.options.position,this.move(this.initPosition,0,!0,!0)):this.initPosition=this.offset,this._dragStart=b.util.bind(this.dragStart,this),this._delayedDragStart=b.util.bind(this.delayedDragStart,this),this._dragMove=b.util.bind(this.dragMove,this),this._dragEnd=b.util.bind(this.dragEnd,this),this.options.delayedStart?(this.element.addEventListener(e.start,this._delayedDragStart),this.element.addEventListener(d.start,this._delayedDragStart)):(this.element.addEventListener(e.start,this._dragStart),this.element.addEventListener(d.start,this._dragStart)),this.bound.refresh&&this.bound.refresh()},a.prototype.reinit=function(){this.offset=mathPoint.getOffset(this.element,this.options.parent,!0),this.fixPosition=this.offset,this.position=this.offset,this.options.position?(this.initPosition=this.options.position,this.move(this.initPosition,0,!0,!0)):this.initPosition=this.offset,this.bound.refresh&&this.bound.refresh()},a.prototype.getSize=function(a){return mathPoint.getSizeOfElement(this.element,this.options.isContentBoxSize)},a.prototype.getPosition=function(){return this.position=this.offset.add(this._transformPosition||new Point(0,0)),this.position},a.prototype.getCenter=function(){return this.position.add(this.getSize().mult(.5))},a.prototype._setTranslate=function(a){this._transformPosition=a;var b=this.element.style[i],c=" translate3d("+a.x+"px,"+a.y+"px, 0px)",d=window.navigator.userAgent,e=d.indexOf("MSIE ");e?(c=" translate("+a.x+"px,"+a.y+"px)",/translate\([^)]+\)/.test(b)?b=b.replace(/translate\([^)]+\)/,c):b+=c):/translate3d\([^)]+\)/.test(b)?b=b.replace(/translate3d\([^)]+\)/,c):b+=c,this.element.style[i]=b},a.prototype.move=function(a,b,c,d){var e=this;b=b||0,a=a.clone(),c&&(this.fixPosition=a),this.determineDirection(a),this.position=a,j&&(e.element.style[j]=b+"ms"),e._setTranslate(a.sub(e.offset)),d||e.onMove.fire()},a.prototype.refreshPosition=function(){this.setPosition(this.getPosition())},a.prototype.setPosition=function(a){a=a.clone(),this.position=a,j&&(this.element.style[j]="0ms"),this._setTranslate(a.sub(this.offset))},a.prototype.setZeroTransition=function(){j&&(this.element.style[j]="0ms")},a.prototype.determineDirection=function(a){this.leftDirection=this.position.x<a.x,this.rightDirection=this.position.x>a.x,this.upDirection=this.position.y>a.y,this.downDirection=this.position.y<a.y},a.prototype.delayedDragStart=function(a){function b(f){var g=c&&f instanceof TouchEvent,j=new Point(g?f.changedTouches[0].pageX:f.clientX,g?f.changedTouches[0].pageY:f.clientY);(Math.abs(j.x-h.x)>5||Math.abs(j.y-h.y)>5)&&(document.removeEventListener(e.move,b),document.removeEventListener(d.move,b),BlockSelection.startDragSelection(i,a),i.dragStart(a))}function f(a){document.removeEventListener(e.move,b),document.removeEventListener(d.move,b),document.removeEventListener(e.end,f),document.removeEventListener(d.end,f)}var g=c&&a instanceof TouchEvent,h=new Point(g?a.changedTouches[0].pageX:a.clientX,g?a.changedTouches[0].pageY:a.clientY),i=this;a.shiftKey||(document.addEventListener(e.move,b),document.addEventListener(d.move,b),document.addEventListener(e.end,f),document.addEventListener(d.end,f))},a.prototype.dragStart=function(a){if(this.currentEvent=a,this._enable&&(!this.options.startFilter||this.options.startFilter(a))){var b=c&&a instanceof TouchEvent;this._startTouchPoint=new Point(b?a.changedTouches[0].pageX:a.clientX,b?a.changedTouches[0].pageY:a.clientY),this._startPosition=this.getPosition(),b&&(this._touchId=a.changedTouches[0].identifier),a.stopPropagation(),a.target instanceof HTMLInputElement||a.target instanceof HTMLInputElement?a.target.focus():a.preventDefault(),document.addEventListener(e.move,this._dragMove),document.addEventListener(d.move,this._dragMove),document.addEventListener(e.end,this._dragEnd),document.addEventListener(d.end,this._dragEnd),this.isDragee=!0,this.onStart.fire(a),this.element.addClass("active"),this.onMove.fire(a)}},a.prototype.dragMove=function(a){this.currentEvent=a;var d,e,f,g=c&&a instanceof TouchEvent;(!g||(d=b.util.getTouchByID(a,this._touchId)))&&(a.stopPropagation(),a.preventDefault(),e=new Point(g?d.pageX:a.clientX,g?d.pageY:a.clientY),f=this._startPosition.add(e.sub(this._startTouchPoint)),f=this.bound(f,this.getSize()),this.touchPoint=e,this.move(f,0))},a.prototype.dragEnd=function(a){var f,g=c&&a instanceof TouchEvent;(!g||(f=b.util.getTouchByID(a,this._touchId)))&&(a.stopPropagation(),a.preventDefault(),this.onEnd.fire(a),document.removeEventListener(e.move,this._dragMove),document.removeEventListener(d.move,this._dragMove),document.removeEventListener(e.end,this._dragEnd),document.removeEventListener(d.end,this._dragEnd),this.isDragee=!1,this.element.removeClass("active"))},a.prototype.getRectangle=function(){return new Rectangle(this.position,this.getSize())},a.prototype.refresh=function(){this.getSize(!0),this.bound.refresh&&this.bound.refresh()},a.prototype.destroy=function(){this.element.removeEventListener(e.start,this._dragStart),this.element.removeEventListener(d.start,this._dragStart),this.element.removeEventListener(e.move,this._dragMove),this.element.removeEventListener(d.move,this._dragMove),this.element.removeEventListener(e.end,this._dragEnd),this.element.removeEventListener(d.end,this._dragEnd),this.onEnd.reset(),this.onMove.reset()},a.prototype.__defineGetter__("enable",function(){return this._enable}),a.prototype.__defineSetter__("enable",function(a){return a?this.element.removeClass("disable"):this.element.addClass("disable"),this._enable=a}),b.draggables=g,b.Draggable=a,window.Dragee=b}(),function(){"use strict";function a(a,b){var e;this.options={timeEnd:200,timeExcange:400,radius:30,getLength:mathPoint.getLength(),isDisplacement:!1};for(e in b)b.hasOwnProperty(e)&&(this.options[e]=b[e]);this.draggables=a,d.push(this),this.onChange=new c.Event(this),b&&b.onChange&&this.onChange.add(b.onChange),this.init()}function b(b,d,e){var f,g,h;return e=e||{},g=e.draggable||{},h=e.list||{},g.parent=g.parent||b,d=Array.prototype.slice.call(d),f=d.map(function(a){return new c.Draggable(a,g)}),new a(f,h)}var c=window.Dragee||{},d=[];a.prototype.init=function(){this._enable=!0,this.draggables.forEach(this.initDraggable,this)},a.prototype.initDraggable=function(a){var b,c=this;a.enable=this._enable,this.options.isDisplacement?(b=function(){return this.isDragee?(c.onStart(this),a.onMove.remove(b),!0):void 0},a.onEnd.add(function(){return c.onEndDisplaycement(this),a.onMove.add(b),!0}),a.onMove.add(b)):a.onEnd.add(function(){return c.onEnd(this),!0})},a.prototype.moveOrSave=function(a,b,c){a.isDragee?a.fixPosition=b:a.move(b,c,!0)},a.prototype.onEnd=function(a){var b,c,d=this.getCurrentFixPosition();return b=this.draggables.indexOf(a),c=mathPoint.indexOfNearPoint(d,a.position,this.options.radius,this.options.getLength),-1===c||c===b?a.move(a.fixPosition,this.options.timeEnd,!0):(this.moveOrSave(this.draggables[c],d[b],this.options.timeExcange),this.draggables[b].move(d[c],this.options.timeEnd,!0),this.onChange.fire()),!0},a.prototype.onEndDisplaycement=function(a){var b,c,d,e=this.getSortedDraggables(),f=e.map(function(a){return a.fixPosition});if(b=e.indexOf(a),d=mathPoint.indexOfNearPoint(f,a.position,this.options.radius,this.options.getLength),-1!==d){if(b>d)for(c=d;b>c;c++)this.moveOrSave(e[c],f[c+1],this.options.timeExcange);else for(c=b;d>c;c++)this.moveOrSave(e[c+1],f[c],this.options.timeExcange);a.move(f[d],this.options.timeEnd,!0)}else a.move(a.fixPosition,this.options.timeEnd,!0)},a.prototype.onStart=function(a){var b,c,d=this.getSortedDraggables(),e=d.map(function(a){return a.fixPosition});for(b=d.indexOf(a),c=b+1;c<d.length;c++)this.moveOrSave(d[c],e[c-1],this.options.timeExcange);d[b].fixPosition=e[c-1]},a.prototype.getCurrentFixPosition=function(){return this.draggables.map(function(a){return a.fixPosition.clone()})},a.prototype.getSortedDraggables=function(){var a,b=this.draggables.map(function(a){return a.initPosition});return a=b.map(function(a){return this.draggables.filter(function(b){return b.fixPosition.compare(a)},this)[0]},this)},a.prototype.reset=function(){this.draggables.forEach(function(a){a.move(a.initPosition,0,!0,!1)})},a.prototype.refresh=function(){this.draggables.forEach(function(a){a.refresh()})},a.prototype.add=function(a){a instanceof Array||(a=[a]),a.forEach(this.initDraggable,this),this.draggables=this.draggables.concat(a)},a.prototype.remove=function(a){var b,d=this.draggables.map(function(a){return a.initPosition}),e=[],f=this.getSortedDraggables();a instanceof Array||(a=[a]),a.forEach(function(a){a.onEnd.reset(),a.onMove.reset(),this.draggables.removeItem(a),c.util.remove(this.draggables,a)},this),b=0,f.forEach(function(a,c){-1!==this.draggables.indexOf(a)&&(a.fixPosition!==d[b]&&a.move(d[b],this.options.timeExcange,!0),a.initPosition=d[b],b++,e.push(a))},this),this.draggables=e},a.prototype.clear=function(){this.remove(this.draggables.slice())},a.prototype.destroy=function(){this.draggables.forEach(function(a){a.destroy()})},a.prototype.__defineGetter__("positions",function(){return this.getCurrentFixPosition()}),a.prototype.__defineSetter__("positions",function(a){var b="wrong array length";if(a.length!==this.draggables.length)throw alert(b),b;a.forEach(function(a,b){this.draggables[b].move(a,0,!0,!0)},this)}),a.prototype.__defineGetter__("enable",function(){return this._enable}),a.prototype.__defineSetter__("enable",function(a){this._enable=a,this.draggables.forEach(function(b){b.enable=a})}),c.lists=d,c.List=a,c.listFactory=b,window.Dragee=c}(),function(){"use strict";function a(a,b){b=b||{},b.stepOn=b.stepOn||new Point(-50,0),c.List.call(this,a,b)}function b(b,d,e){var f,g,h;return e=e||{},g=e.draggable||{},h=e.list||{},g.parent=g.parent||b,d=Array.prototype.slice.call(d),f=d.map(function(a){return new c.Draggable(a,g)}),new a(f,h)}var c=window.Dragee||{};extend(a,c.List),a.prototype.init=function(){var a=this;this.draggables.forEach(function(b){b.isOn=!1,b.onEnd.add(function(){return a.onEnd(this),!0})})},a.prototype.onEnd=function(a){var b,c,d=this.getCurrentFixPositionWithOff();return b=this.draggables.indexOf(a),c=mathPoint.indexOfNearPoint(d,a.position,this.options.radius,this.options.getLength),-1===c||c===b?this.moveDraggable(b,a.position,d[b],this.options.timeEnd):(this.draggables[c].isDragee?this.fixToOff(c,d[b]):this.moveDraggableToOff(c,d[b],this.options.timeExcange),this.moveDraggable(b,a.position,d[c],this.options.timeEnd),this.onChange.fire()),!0},a.prototype.moveDraggable=function(a,b,c,d){var e=[c,c.add(this.options.stepOn)],f=mathPoint.indexOfNearPoint(e,b,-1,mathPoint.getLength({x:!0}));this.draggables[a].isOn!==!!f&&(this.draggables[a].isOn=!!f,this.onChange.fire()),this.draggables[a].move(e[f],d,!0)},a.prototype.fixToOff=function(a,b){this.draggables[a].isOn=!1,this.draggables[a].fixPosition=b},a.prototype.moveDraggableToOff=function(a,b,c){this.draggables[a].isOn=!1,this.draggables[a].move(b,c,!0)},a.prototype.getCurrentFixPositionWithOff=function(){return this.draggables.map(function(a){return a.isOn?a.fixPosition.sub(this.options.stepOn):a.fixPosition.clone()},this)},a.prototype.getSortedDraggables=function(){return this.draggables.map(function(a){return a.initPosition}).map(function(a){return this.draggables.filter(function(b){return b.fixPosition.compare(a)||b.fixPosition.compare(a.add(this.options.stepOn))},this)[0]},this)},a.prototype.reset=function(){this.draggables.forEach(function(a){a.move(a.initPosition,0,!0,!1),a.isOn=!1})},a.prototype.__defineGetter__("positions",function(){return this.draggables.map(function(a){var b=a.fixPosition.clone();return b.isOn=a.isOn,b})}),a.prototype.__defineSetter__("positions",function(a){var b="wrong array length";if(a.length!==this.draggables.length)throw alert(b),b;a.forEach(function(a,b){this.draggables[b].isOn=a.isOn,this.draggables[b].move(a,0,!0,!0)},this)}),c=c||{},c.ListSwitcher=a,c.listSwitcherFactory=b,window.Dragee=c}(),function(){"use strict";function a(a,b,d){var e,f=mathPoint.createRectangleFromElement(a,a);this.options={angle:0,dAngle:2*Math.PI/b.length,center:f.getCenter(),startRadius:50,endRadius:f.getMinSide()/2,lineWidth:2,strokeStyle:"#ff5577",fillStyle:"rgba(150,255,50,0.8)"};for(e in d)d.hasOwnProperty(e)&&(this.options[e]=d[e]);c.push(this),this.area=a,this.areaRectangle=f,this.init(b)}var b=window.Dragee||{},c=[];a.prototype.init=function(a){var c=this;this.canvas=b.util.createCanvas(this.area,this.areaRectangle),this.context=this.canvas.getContext("2d"),this.draggables=a.map(function(a,d){var e=this.options.angle+d*this.options.dAngle,f=mathPoint.getSizeOfElement(a).mult(.5),g=mathPoint.getPointFromRadialSystem(e,this.options.startRadius,this.options.center).sub(f),h=mathPoint.getPointFromRadialSystem(e,this.options.endRadius,this.options.center).sub(f),i=b.boundFactory(b.boundType.line)(g,h);return new b.Draggable(a,{parent:this.area,bound:i,position:g,onMove:function(){return c.draw(),!0}})},this),this.isInit=!0,this.draw()},a.prototype.draw=function(){var a,b;if(this.isInit){for(this.context.clearRect(0,0,this.areaRectangle.size.x,this.areaRectangle.size.y),this.context.beginPath(),a=this.draggables[0].getCenter(),this.context.moveTo(a.x,a.y),b=0;b<this.draggables.length;b++)a=this.draggables[b].getCenter(),this.context.lineTo(a.x,a.y);this.context.closePath(),this.context.lineWidth=this.options.lineWidth,this.context.strokeStyle=this.options.strokeStyle,this.context.stroke(),this.context.fillStyle=this.options.fillStyle,this.context.fill()}},b.spiders=c,b.Spider=a,window.Dragee=b}(),function(){"use strict";function a(a,d,e){e=e||{};var f,g=e.parent||b.util.getDefaultParent(a);this.options={timeEnd:200,
timeExcange:400,parent:g,sorting:b.sortingFactory(b.positionType.floatLeft)(80,mathPoint.getLength({x:1,y:4,isTransformationSpace:!0})),positioning:b.positionFactory(b.positionType.floatLeft)(this.getRectangle.bind(this),{removable:!0})};for(f in e)this.options[f]=e[f];c.push(this),this.element=a,this.draggables=d,this.onAdd=new b.Event(this),this.beforeAdd=new b.Event(this),this.onRemove=new b.Event(this),e.onRemove&&this.onRemove.add(e.onRemove),e.onAdd&&this.onAdd.add(e.onAdd),e.beforeAdd&&this.beforeAdd.add(e.beforeAdd),this.init()}var b=window.Dragee||{},c=[];a.prototype.getRectangle=function(){return mathPoint.createRectangleFromElement(this.element,this.options.parent,this.options.isContentBoxSize,!0)},a.prototype.catchDraggable=function(a){if(this.options.catchDraggable)return this.options.catchDraggable(this,a);var b=this.getRectangle(),c=a.getRectangle().getSquare();return c<b.getSquare()&&b.includePoint(a.getCenter())},a.prototype.getPosition=function(){return this.getRectangle().position},a.prototype.getSize=function(){return this.getRectangle().size},a.prototype.init=function(){var a,c;this.innerDraggables=this.draggables.filter(function(a){for(var b=a.element.parentNode;b;){if(b===this.element)return!0;b=b.parentNode}return!1},this),this.innerDraggables.length&&(c=b.util.range(this.innerDraggables.length),a=this.options.positioning(this.innerDraggables.map(function(a){return a.getRectangle()}),c),this.setPosition(a,c),this.innerDraggables.forEach(function(a){this.onAdd.fire(a)},this))},a.prototype.destroy=function(){b.targetManagers.forEach(function(a){a.targets.removeItem(this)},this)},a.prototype.refresh=function(){var a=this.options.positioning(this.innerDraggables.map(function(a){return a.getRectangle()}),[]);this.setPosition(a,[],0)},a.prototype.onEnd=function(a){var b,c=[],d=this.getRectangle().includePoint(a.getPosition());if(!d){if(!this.getRectangle().includePoint(a.getCenter()))return!1;a.position=a.getCenter().clone()}return this.beforeAdd.fire(a),this.innerDraggables=this.options.sorting(this.innerDraggables,[a],c),b=this.options.positioning(this.innerDraggables.map(function(a){return a.getRectangle()}),c,a),this.setPosition(b,c),-1!==this.innerDraggables.indexOf(a)&&this.addRemoveOnMove(a),!0},a.prototype.setPosition=function(a,b,c){this.innerDraggables.slice(0).forEach(function(d,e){var f=a[e],g=c||0==c?c:-1!==b.indexOf(e)?this.options.timeEnd:this.options.timeExcange;f.removable?(d.move(d.initPosition,g,!0,!0),this.innerDraggables.removeItem(d),this.onRemove.fire(d)):d.move(f.position,g,!0,!0)},this)},a.prototype.add=function(a,b){var c,d=this.innerDraggables.length;this.beforeAdd.fire(a),this.pushInnerDraggable(a),c=this.options.positioning(this.innerDraggables.map(function(a){return a.getRectangle()}),d,a),this.setPosition(c,[d],b||0),-1!==this.innerDraggables.indexOf(a)&&this.addRemoveOnMove(a)},a.prototype.pushInnerDraggable=function(a){-1===this.innerDraggables.indexOf(a)&&this.innerDraggables.push(a)},a.prototype.addRemoveOnMove=function(a){var b=this;a.onMove.add(this.removeHandler=function(){b.remove(a)}),this.onAdd.fire(a)},a.prototype.remove=function(a){var b,c;a.onMove.remove(this.removeHandler),b=this.innerDraggables.indexOf(a),-1!==b&&(this.innerDraggables.splice(b,1),c=this.options.positioning(this.innerDraggables.map(function(a){return a.getRectangle()}),[]),this.setPosition(c,[]),this.onRemove.fire(a))},a.prototype.reset=function(){this.innerDraggables.forEach(function(a){a.move(a.initPosition,0,!0,!0),this.onRemove.fire(a)},this),this.innerDraggables=[]},a.prototype.getSortedDraggables=function(){this.innerDraggables.slice()},b.targets=c,b.Target=a,window.Dragee=b}(),function(){"use strict";function a(a,b,e,f){var g;this.element=a,this.draggables=b,this.targets=e,d.push(this),this.options={timeEnd:400,timeWaitForRefresh:500};for(g in f)f.hasOwnProperty(g)&&(this.options[g]=f[g]);this.onChange=new c.Event(this),f&&f.onChange&&this.onChange.add(f.onChange),this.init()}function b(b,d,e,f){var g,h,i,j,k;return f=f||{},i=f.draggable||{},j=f.target||{},k=f.manager||{},i.parent=i.parent||b,j.parent=j.parent||b,d=Array.prototype.slice.call(d),e=Array.prototype.slice.call(e),g=d.map(function(a){return new c.Draggable(a,i)}),h=e.map(function(a){return new c.Target(b,g,j)}),new a(b,g,h,k)}var c=window.Dragee||{},d=[];a.prototype.init=function(){var a=this;this.draggables.forEach(function(b){b.onEnd.add(function(){return a.onEnd(this)})})},a.prototype.addDraggable=function(a){var b=this;this.draggables.push(a),a.onEnd.unshift(function(){return b.onEnd(this)})},a.prototype.onEnd=function(a){var b=this.targets.filter(function(b){return-1!==b.draggables.indexOf(a)}).filter(function(b){return b.catchDraggable(a)}).sort(function(a,b){return a.getRectangle().getSquare()-b.getRectangle().getSquare()});return b.length?b[0].onEnd(a):a.move(a.initPosition,this.options.timeEnd,!0,!0),this.onChange.fire(),!0},a.prototype.reset=function(){this.targets.forEach(function(a){a.reset()})},a.prototype.refresh=function(){this.draggables.forEach(function(a){a.refresh()}),this.targets.forEach(function(a){a.refresh()})},a.prototype.__defineGetter__("positions",function(){return this.targets.map(function(a){return a.innerDraggables.map(function(a){return this.draggables.indexOf(a)},this)},this)}),a.prototype.__defineSetter__("positions",function(a){var b="wrong array length";if(a.length!==this.targets.length)throw alert(b),b;this.targets.forEach(function(a){a.reset()},this),a.forEach(function(a,b){a.forEach(function(a){this.targets[b].add(this.draggables[a])},this)},this)}),c.targetManagers=d,c.TargetManager=a,c.targetManagerFactory=b,window.Dragee=c}();