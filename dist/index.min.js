var Dragee=function(t){"use strict";function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t,e,n){return(r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&o(r,n.prototype),r}).apply(null,arguments)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?l(t):e}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(n,t){return t.reduce(function(t,e){return t+parseInt(window.getComputedStyle(n)[e]||0)},0)}var f=function(){function o(t,e){u(this,o),this.x=t,this.y=e}return e(o,[{key:"add",value:function(t){return new o(this.x+t.x,this.y+t.y)}},{key:"sub",value:function(t){return new o(this.x-t.x,this.y-t.y)}},{key:"mult",value:function(t){return new o(this.x*t,this.y*t)}},{key:"negative",value:function(){return new o(-this.x,-this.y)}},{key:"compare",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"clone",value:function(){return new o(this.x,this.y)}},{key:"toString",value:function(){return"{x=".concat(this.x,",y=").concat(this.y)}}],[{key:"elementOffset",value:function(t,e){e=e||t.parentNode;var n=t.getBoundingClientRect(),i=e.getBoundingClientRect();return new o(n.left-i.left,n.top-i.top)}},{key:"elementSize",value:function(t,e){var n=1<arguments.length&&void 0!==e&&e,i=parseInt(window.getComputedStyle(t).width),r=parseInt(window.getComputedStyle(t).height);return n||(i+=d(t,["padding-left","padding-right","border-left-width","border-right-width"]),r+=d(t,["padding-top","padding-bottom","border-top-width","border-bottom-width"])),new o(i,r)}}]),o}(),v=function(){function a(t,e){u(this,a),this.position=t,this.size=e}return e(a,[{key:"getP1",value:function(){return this.position}},{key:"getP2",value:function(){return new f(this.position.x+this.size.x,this.position.y)}},{key:"getP3",value:function(){return this.position.add(this.size)}},{key:"getP4",value:function(){return new f(this.position.x,this.position.y+this.size.y)}},{key:"getCenter",value:function(){return this.position.add(this.size.mult(.5))}},{key:"or",value:function(t){var e=new f(Math.min(this.position.x,t.position.x),Math.min(this.position.y,t.position.y));return new a(e,new f(Math.max(this.position.x+this.size.x,t.position.x+t.size.x),Math.max(this.position.y+this.size.y,t.position.y+t.size.y)).sub(e))}},{key:"and",value:function(t){var e=new f(Math.max(this.position.x,t.position.x),Math.max(this.position.y,t.position.y)),n=new f(Math.min(this.position.x+this.size.x,t.position.x+t.size.x),Math.min(this.position.y+this.size.y,t.position.y+t.size.y)).sub(e);return n.x<=0||n.y<=0?null:new a(e,n)}},{key:"includePoint",value:function(t){return!(this.position.x>t.x||this.position.x+this.size.x<t.x||this.position.y>t.y||this.position.y+this.size.y<t.y)}},{key:"includeRectangle",value:function(t){return this.includePoint(t.position)&&this.includePoint(t.getP3())}},{key:"moveToBound",value:function(t,e){var n,i;if(e)n=e;else{if(!(i=this.and(t)))return t;n=i.size.x>i.size.y?"y":"x"}var r=this.getCenter(),o=t.getCenter(),s=0<(r[n]>o[n]?-1:1)?this.position[n]+this.size[n]-t.position[n]:this.position[n]-(t.position[n]+t.size[n]);return t.position[n]=t.position[n]+s,t}},{key:"getSquare",value:function(){return this.size.x*this.size.y}},{key:"styleApply",value:function(t){(t=t||document.querySelector("ind")).style.left=this.position.x+"px",t.style.top=this.position.y+"px",t.style.width=this.size.x+"px",t.style.height=this.size.y+"px"}},{key:"growth",value:function(t){this.size=this.size.add(t),this.position=this.position.add(t.mult(-.5))}},{key:"getMinSide",value:function(){return Math.min(this.size.x,this.size.y)}}],[{key:"fromElement",value:function(t,e,n,i){var r=1<arguments.length&&void 0!==e?e:t.parentNode,o=2<arguments.length&&void 0!==n&&n,s=3<arguments.length&&void 0!==i&&i;return new a(f.elementOffset(t,r,s),f.elementSize(t,o))}}]),a}();function p(t,e){!function(t,e){return new RegExp("(^|\\s)"+e+"(\\s|$)","g").test(t.className)}(t,e)&&(t.className=(t.className+" "+e).replace(/\s+/g," ").replace(/(^ | $)/g,""))}function y(t,e){var n=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(n,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"")}function m(t){for(var e=t.parentNode;e.parentNode&&"static"===window.getComputedStyle(e).position&&"BODY"!==e.tagName;)e=e.parentNode;return e}var n=function(){function a(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(u(this,a),this.context=t||this,this.events={},e&&e.on)for(var n=0,i=Object.entries(e.on);n<i.length;n++){var r=g(i[n],2),o=r[0],s=r[1];this.on(o,s)}}return e(a,[{key:"emit",value:function(t){this.interrupted=!1;var e=[].slice.call(arguments,1);if(this.events[t]){var n=!0,i=!1,r=void 0;try{for(var o,s=this.events[t][Symbol.iterator]();!(n=(o=s.next()).done);n=!0){if(o.value.apply(this.context,e),this.interrupted)return}}catch(t){i=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}}}},{key:"interrupt",value:function(){this.interrupted=!0}},{key:"on",value:function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}},{key:"prependOn",value:function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].unshift(e)}},{key:"unsubscribe",value:function(t,e){if(this.events[t]){var n=this.events[t].indexOf(e);this.events[t].splice(n,1)}}},{key:"resetEmitter",value:function(){this.events={}}},{key:"resetOn",value:function(t){this.events[t]=[]}}]),a}();var b,x=(function(t,e){var r,o;r="Webkit Moz ms Ms O".split(" "),o=document.documentElement.style,t.exports=function(t){if(t){if("string"==typeof o[t])return t;var e;t=t.charAt(0).toUpperCase()+t.slice(1);for(var n=0,i=r.length;n<i;n++)if(e=r[n]+t,"string"==typeof o[e])return e}}}(b={exports:{}},b.exports),b.exports);function w(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function P(t,e){return Math.abs(t.y-e.y)}function E(n){return function(t,e){return Math.sqrt(Math.pow(n.x*Math.abs(t.x-e.x),2)+Math.pow(n.y*Math.abs(t.y-e.y),2))}}function k(t,e,n){var i,r,o,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:w,a=0;if(0===t.length)return-1;for(i=s(t[0],e),r=0;r<t.length;r++)(o=s(t[r],e))<i&&(i=o,a=r);return 0<=n&&n<i?-1:a}function D(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n/w(t,e);return new f(t.x+o*i,t.y+o*r)}function _(t,e,n){for(var i=t.filter(function(t){return t.y>e.y||(n?t.x<e.x:t.x>e.x)}),r=0;r<i.length;r++)if(e.y<i[r].y)return i.splice(r,0,e),i;return i.push(e),i}function S(t,e){var n=Math.min(t,e),i=Math.max(t,e);return Math.min(i-n,n+2*Math.PI-i)}function A(t,e){var n=e.sub(t);return O(Math.atan2(n.y,n.x))}function O(t){for(;t<0;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t}function M(t,e,n){return(n=n||new f(0,0)).add(new f(e*Math.cos(t),e*Math.sin(t)))}var L=function(){function t(){u(this,t)}return e(t,[{key:"bound",value:function(t){return t}},{key:"refresh",value:function(){}}],[{key:"bounding",value:function(){var t=r(this,Array.prototype.slice.call(arguments));return t.bound.bind(t)}}]),t}(),R=function(){function n(t){var e;return u(this,n),(e=c(this,h(n).call(this))).rectangle=t,e}return a(n,L),e(n,[{key:"bound",value:function(t,e){var n=t.clone(),i=this.rectangle.getP3();return this.rectangle.position.x>n.x&&(n.x=this.rectangle.position.x),this.rectangle.position.y>n.y&&(n.y=this.rectangle.position.y),i.x<n.x+e.x&&(n.x=i.x-e.x),i.y<n.y+e.y&&(n.y=i.y-e.y),n}}]),n}(),T=function(){function i(t,e){var n;return u(this,i),(n=c(this,h(i).call(this,v.fromElement(t,e)))).element=t,n.parent=e,n}return a(i,R),e(i,[{key:"refresh",value:function(){this.rectangle=v.fromElement(this.element,this.parent)}}]),i}(),z=function(){function r(t,e,n){var i;return u(this,r),(i=c(this,h(r).call(this))).x=t,i.startY=e,i.endY=n,i}return a(r,L),e(r,[{key:"bound",value:function(t,e){var n=t.clone();return n.x=this.x,this.startY>n.y&&(n.y=this.startY),this.endY<n.y+e.y&&(n.y=this.endY-e.y),n}}]),r}(),C=function(){function r(t,e,n){var i;return u(this,r),(i=c(this,h(r).call(this))).y=t,i.startX=e,i.endX=n,i}return a(r,L),e(r,[{key:"bound",value:function(t,e){var n=t.clone();return n.y=this.y,this.startX>n.x&&(n.x=this.startX),this.endX<n.x+e.x&&(n.x=this.endX-e.x),n}}]),r}(),I=function(){function r(t,e){var n;u(this,r),(n=c(this,h(r).call(this))).startPoint=t,n.endPoint=e;var i=Math.atan2(e.y-t.y,e.x-t.x)+Math.PI/2;return n.someK=10,n.cosBeta=Math.cos(i),n.sinBeta=Math.sin(i),n}return a(r,L),e(r,[{key:"bound",value:function(t,e){var n=new f(t.x+this.someK*this.cosBeta,t.y+this.someK*this.sinBeta),i=D(this.endPoint,this.startPoint,e.x),r=function(t,e,n,i){var r,o,s,a,u,h;return n.x===i.x&&(r=n,n=t,t=r,r=i,i=e,e=r),t.x===e.x?(s=(i.y-n.y)/(i.x-n.x),u=(i.x*n.y-n.x*i.y)/(i.x-n.x),h=t.x,new f(h,h*s+u)):(o=(e.y-t.y)/(e.x-t.x),a=(e.x*t.y-t.x*e.y)/(e.x-t.x),s=(i.y-n.y)/(i.x-n.x),u=(i.x*n.y-n.x*i.y)/(i.x-n.x),new f(h=(a-u)/(s-o),h*o+a))}(this.startPoint,this.endPoint,t,n);return function(t,e,n){var i=new f(n.x-t.x,n.y-t.y),r=new f(e.x-t.x,e.y-t.y),o=r.x*r.x+r.y*r.y,s=(i.x*r.x+i.y*r.y)/o;return new f(t.x+r.x*s,t.y+r.y*s)}(this.startPoint,i,r)}}]),r}(),B=function(){function i(t,e){var n;return u(this,i),(n=c(this,h(i).call(this))).center=t,n.radius=e,n}return a(i,L),e(i,[{key:"bound",value:function(t){return D(this.center,t,this.radius)}}]),i}(),N=function(){function o(t,e,n,i){var r;return u(this,o),(r=c(this,h(o).call(this,t,e)))._startAngle=n,r._endAngle=i,r}return a(o,B),e(o,[{key:"startAngle",value:function(){return"function"==typeof this._startAngle?this._startAngle():this._startAngle}},{key:"endAngle",value:function(){return"function"==typeof this._endAngle?this._endAngle():this._endAngle}},{key:"bound",value:function(t){var e=A(this.center,t);return e=O(e),M(e=function(t,e,n){return t<e&&t<n&&n<e?n:e<t&&(n<e||t<n)?n:S(t,n)<S(e,n)?t:e}(this.startAngle(),this.endAngle(),e),this.radius,this.center)}}]),o}();function j(t,e){for(var n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),n--);return t}function Y(t,e,n){var i=[];if(void 0===e&&(e=t,t=0),void 0===n&&(n=1),0<n&&e<=t||n<0&&t<=e)return[];for(var r=t;0<n?r<e:e<r;r+=n)i.push(r);return i}var X=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};u(this,n),this.rectangle=t,this.options=e}return e(n,[{key:"boundRect",get:function(){return"function"==typeof this.rectangle?this.rectangle():this.rectangle}}]),n}(),F=function(){function t(){return u(this,t),c(this,h(t).apply(this,arguments))}return a(t,X),e(t,[{key:"positioning",value:function(i,r){var e=this,o=i.reduce(function(t,e,n){return-1===r.indexOf(n)&&t.push(n),t},[]);return r.forEach(function(t){var n=i[t];o.forEach(function(t){var e=i[t];n=e.moveToBound(n)}),o.some(function(t){return!!i[t].and(n)})||n.and(e.boundRect).getSquare()!==n.getSquare()?n.removable=!0:o.push(t)}),i}},{key:"sorting",value:function(t,e,n){var i=t.concat(e);return e.forEach(function(t){n.push(i.indexOf(t))}),i}}]),t}(),G=function(){function i(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,i),(e=c(this,h(i).call(this,t,n))).options=Object.assign({removable:!0},n),e.radius=n.radius||80,e.paddingTopLeft=n.paddingTopLeft||new f(0,0),e.paddingBottomRight=n.paddingBottomRight||new f(0,0),e.yGapBetweenDraggables=n.yGapBetweenDraggables||0,e.getDistance=n.getDistance||w,e.getPosition=n.getPosition||function(t){return t.position},e}return a(i,X),e(i,[{key:"positioning",value:function(t){var o=this,s=this.boundRect,a=s.getP2(),u=[s.position];return t.forEach(function(t,e){for(var n,i=!1,r=0;r<u.length&&!(i=(n=new f(u[r].x+o.paddingTopLeft.x,0<r?u[r-1].y+o.yGapBetweenDraggables:s.position.y+o.paddingTopLeft.y)).x+t.size.x<a.x);r++);i||(n=new f(s.position.x+o.paddingTopLeft.x,u[u.length-1].y+(0<e?o.yGapBetweenDraggables:o.paddingTopLeft.y))),t.position=n,o.options.removable&&t.getP3().y>s.getP3().y&&(t.removable=!0),u=_(u,t.getP3().add(o.paddingBottomRight))}),t}},{key:"sorting",value:function(n,t,e){var i=this,r=n.concat(),o=n.map(function(t){return t.getPosition()});return t.forEach(function(t){var e=k(o,i.getPosition(t),i.radius,i.getDistance);e=-1===e?r.length:r.indexOf(n[e]),r.splice(e,0,t)}),t.forEach(function(t){e.push(r.indexOf(t))}),r}}]),i}(),q=function(){function i(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,i),(e=c(this,h(i).call(this,t,n))).paddingTopRight=n.paddingTopRight||new f(5,5),e.paddingBottomLeft=n.paddingBottomLeft||new f(0,0),e.yGapBetweenDraggables=n.yGapBetweenDraggables||0,e.paddingBottomNegLeft=new f(-e.paddingBottomLeft.x,e.paddingBottomLeft.y),e}return a(i,G),e(i,[{key:"positioning",value:function(t){var o=this,s=this.boundRect,a=[s.getP2()];return t.forEach(function(t,e){for(var n,i=!1,r=0;r<a.length&&!(i=(n=new f(a[r].x-t.size.x-o.paddingTopRight.x,0<r?a[r-1].y+o.yGapBetweenDraggables:s.position.y+o.paddingTopRight.y)).x>t.position.x);r++);i||(n=new f(s.getP2().x-t.size.x-o.paddingTopRight.x,a[a.length-1].y+(0<e?o.yGapBetweenDraggables:o.paddingTopRight.y))),t.position=n,o.options.removable&&t.getP4().y>s.getP4().y&&(t.removable=!0),a=_(a,t.getP4().add(o.paddingBottomNegLeft),!0)}),t}}]),i}(),H=function(){function s(t,e){var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};u(this,s);var r=l(n=c(this,h(s).call(this,void 0,i))),o=i.parent||m(t);return n.options=Object.assign({timeEnd:200,timeExcange:400,parent:o},i),n.positioningStrategy=i.strategy||new G(n.getRectangle.bind(l(n)),{radius:80,getDistance:E({x:1,y:4}),removable:!0}),n.element=t,e.forEach(function(t){return t.targets.push(r)}),n.draggables=e,s.emitter.emit("target:create",l(n)),n.init(),n}return a(s,n),e(s,[{key:"positioning",value:function(t,e){return this.positioningStrategy.positioning(t,e)}},{key:"sorting",value:function(t,e,n){return this.positioningStrategy.sorting(t,e,n)}},{key:"init",value:function(){var t,e,n=this;this.innerDraggables=this.draggables.filter(function(t){for(var e=t.element.parentNode;e;){if(e===n.element)return!0;e=e.parentNode}return!1}),this.innerDraggables.length&&(e=Y(this.innerDraggables.length),t=this.positioning(this.innerDraggables.map(function(t){return t.getRectangle()}),e),this.setPosition(t,e),this.innerDraggables.forEach(function(t){return n.emit("target:add",t)}))}},{key:"getRectangle",value:function(){return v.fromElement(this.element,this.options.parent,this.options.isContentBoxSize,!0)}},{key:"catchDraggable",value:function(t){if(this.options.catchDraggable)return this.options.catchDraggable(this,t);var e=this.getRectangle();return t.getRectangle().getSquare()<e.getSquare()&&e.includePoint(t.getCenter())}},{key:"getPosition",value:function(){return this.getRectangle().position}},{key:"getSize",value:function(){return this.getRectangle().size}},{key:"destroy",value:function(){var e=this;$.forEach(function(t){return j(t.targets,e)})}},{key:"refresh",value:function(){var t=this.positioning(this.innerDraggables.map(function(t){return t.getRectangle()}),[]);this.setPosition(t,[],0)}},{key:"onEnd",value:function(t){var e=[];if(!this.getRectangle().includePoint(t.getPosition())){if(!this.getRectangle().includePoint(t.getCenter()))return!1;t.position=t.getCenter().clone()}this.emit("target:beforeAdd",t),this.innerDraggables=this.sorting(this.innerDraggables,[t],e);var n=this.positioning(this.innerDraggables.map(function(t){return t.getRectangle()}),e);return this.setPosition(n,e),-1!==this.innerDraggables.indexOf(t)&&this.addRemoveOnMove(t),!0}},{key:"setPosition",value:function(r,o,s){var a=this;this.innerDraggables.slice(0).forEach(function(t,e){var n=r[e],i=s||0===s?s:-1!==o.indexOf(e)?a.options.timeEnd:a.options.timeExcange;n.removable?(t.move(t.initialPosition,i,!0,!0),j(a.innerDraggables,t),a.emit("target:remove",t)):t.move(n.position,i,!0,!0)})}},{key:"add",value:function(t,e){var n=this.innerDraggables.length;this.emit("target:beforeAdd",t),this.pushInnerDraggable(t);var i=this.positioning(this.innerDraggables.map(function(t){return t.getRectangle()}),n,t);this.setPosition(i,[n],e||0),-1!==this.innerDraggables.indexOf(t)&&this.addRemoveOnMove(t)}},{key:"pushInnerDraggable",value:function(t){-1===this.innerDraggables.indexOf(t)&&this.innerDraggables.push(t)}},{key:"addRemoveOnMove",value:function(t){var e=this;t.on("drag:move",this.removeHandler=function(){e.remove(t)}),this.emit("target:add",t)}},{key:"remove",value:function(t){t.unsubscribe("drag:move",this.removeHandler);var e=this.innerDraggables.indexOf(t);if(-1!==e){this.innerDraggables.splice(e,1);var n=this.positioning(this.innerDraggables.map(function(t){return t.getRectangle()}),[]);this.setPosition(n,[]),this.emit("target:remove",t)}}},{key:"reset",value:function(){var e=this;this.innerDraggables.forEach(function(t){t.move(t.initialPosition,0,!0,!0),e.emit("target:remove",t)}),this.innerDraggables=[]}},{key:"getSortedDraggables",value:function(){this.innerDraggables.slice()}}]),s}();H.emitter=new n(H),H.emitter.on("target:create",function(t){K.addTarget(t)});var $=[],W=function(){function r(t,n){var e,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return u(this,r),e=c(this,h(r).call(this,void 0,i)),$.forEach(function(e){t&&t.forEach(function(t){j(e.draggables,t)}),n&&n.forEach(function(t){j(e.targets,t)})}),e.draggables=t||[],e.targets=n||[],$.push(l(e)),e.options={timeEnd:i.timeEnd||400},e.init(),e}return a(r,n),e(r,[{key:"init",value:function(){var e=this;this.draggables.forEach(function(t){t.dragEndAction=function(){return e.onEnd(t)}})}},{key:"addDraggable",value:function(t){var e=this;this.draggables.push(t),t.dragEndAction=function(){return e.onEnd(t)}}},{key:"addTarget",value:function(t){this.targets.push(t)}},{key:"onEnd",value:function(e){var t=this.targets.filter(function(t){return-1!==t.draggables.indexOf(e)}).filter(function(t){return t.catchDraggable(e)}).sort(function(t,e){return t.getRectangle().getSquare()-e.getRectangle().getSquare()});t.length?t[0].onEnd(e):e.targets.length&&e.pinPosition(e.initialPosition,this.options.timeEnd),this.emit("scope:change")}},{key:"reset",value:function(){this.targets.forEach(function(t){return t.reset()})}},{key:"refresh",value:function(){this.draggables.forEach(function(t){return t.refresh()}),this.targets.forEach(function(t){return t.refresh()})}},{key:"positions",get:function(){var e=this;return this.targets.map(function(t){return t.innerDraggables.map(function(t){return e.draggables.indexOf(t)})})},set:function(t){var n=this;if(t.length!==this.targets.length)throw"wrong array length";this.targets.forEach(function(t){return t.reset()}),t.forEach(function(t,e){t.forEach(function(t){n.targets[e].add(n.draggables[t])})})}}]),r}(),K=new W;var V=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){return e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){e=!1}return e}(),U="ontouchstart"in window,J="mousedown",Q="mousemove",Z="mouseup",tt="touchstart",et="touchmove",nt="touchend",it=[],rt=x("transform"),ot=x("transition");function st(t,e){for(var n=0;n<t.changedTouches.length;n++)if(t.changedTouches[n].identifier===e)return t.changedTouches[n];return!1}var at=function(){function s(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,s),(e=c(this,h(s).call(this,void 0,n))).targets=[],e.options=n,e.element=t,function(e){if(it.some(function(t){return e.element===t.element}))throw"for this element Dragee.Draggable is already exist, don't create it twice ";it.push(e)}(l(e)),s.emitter.emit("draggable:create",l(e)),e._enable=!0,e.startBounding(),e.startPositioning(),e.startListening(),e}return a(s,n),e(s,[{key:"startBounding",value:function(){this.bound=this.options.bound||T.bounding(this.parent,this.parent)}},{key:"startPositioning",value:function(){this._setDefaultTransition(),this.offset=f.elementOffset(this.element,this.parent,!0),this.pinnedPosition=this.offset,this.position=this.offset,this.initialPosition=this.options.position||this.offset,this.pinPosition(this.initialPosition),this.bound.refresh&&this.bound.refresh()}},{key:"startListening",value:function(){var e=this;this._dragStart=function(t){return e.dragStart(t)},this._dragMove=function(t){return e.dragMove(t)},this._dragEnd=function(t){return e.dragEnd(t)},this._nativeDragStart=function(t){return e.nativeDragStart(t)},this._nativeDragOver=function(t){return e.nativeDragOver(t)},this._nativeDragEnd=function(t){return e.nativeDragEnd(t)},this._nativeDrop=function(t){return e.nativeDrop(t)},this._scroll=function(t){return e.onScroll(t)},this.handler.addEventListener(tt,this._dragStart,!!V&&{passive:!1}),this.handler.addEventListener(J,this._dragStart,!!V&&{passive:!1}),this.element.addEventListener("dragstart",this._nativeDragStart)}},{key:"getSize",value:function(){return f.elementSize(this.element,this.options.isContentBoxSize)}},{key:"getPosition",value:function(){return this.position=this.offset.add(this._transformPosition||new f(0,0)),this.position}},{key:"getCenter",value:function(){return this.position.add(this.getSize().mult(.5))}},{key:"_setDefaultTransition",value:function(){this.element.style[ot]=window.getComputedStyle(this.element)[ot]}},{key:"_setTransition",value:function(t){var e=this.element.style[ot],n="transform ".concat(t,"ms");/transform \d*m?s/.test(e)?e=e.replace(/transform \d*m?s/,n):e?e+=", ".concat(n):e=n,this.element.style[ot]=e}},{key:"_setTranslate",value:function(t){this._transformPosition=t;var e=this.element.style[rt],n=" translate3d(".concat(t.x,"px, ").concat(t.y,"px, 0px)");-1!==window.navigator.userAgent.indexOf("MSIE ")?(n=" translate(".concat(t.x,"px,").concat(t.y,"px)"),/translate\([^)]+\)/.test(e)?e=e.replace(/translate\([^)]+\)/,n):e+=n):/translate3d\([^)]+\)/.test(e)?e=e.replace(/translate3d\([^)]+\)/,n):e+=n,this.element.style[rt]=e}},{key:"move",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==n&&n;t=t.clone(),this.determineDirection(t),this.position=t,this._setTransition(i),this._setTranslate(t.sub(this.offset)),r||this.emit("drag:move")}},{key:"pinPosition",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=!(2<arguments.length&&void 0!==n)||n;this.pinnedPosition=t.clone(),this.move(this.pinnedPosition,i,r)}},{key:"resetPositionToInitial",value:function(){this.pinPosition(this.initialPosition)}},{key:"refreshPosition",value:function(){this.setPosition(this.getPosition())}},{key:"setPosition",value:function(t){t=t.clone(),this.position=t,this._setTransition(0),this._setTranslate(t.sub(this.offset))}},{key:"determineDirection",value:function(t){this.leftDirection=this.position.x<t.x,this.rightDirection=this.position.x>t.x,this.upDirection=this.position.y>t.y,this.downDirection=this.position.y<t.y}},{key:"dragStart",value:function(t){if(this.currentEvent=t,this._enable){var e=U&&t instanceof window.TouchEvent;if(this.touchPoint=this._startTouchPoint=new f(e?t.changedTouches[0].pageX:t.clientX,e?t.changedTouches[0].pageY:t.clientY),this._startPosition=this.getPosition(),e&&(this._touchId=t.changedTouches[0].identifier),this._startScrollPoint=new f(window.scrollX,window.scrollY),t.stopPropagation(),(t.target instanceof window.HTMLInputElement||t.target instanceof window.HTMLInputElement)&&t.target.focus(),this.nativeDragAndDrop||t.target instanceof window.HTMLInputElement||t.target instanceof window.HTMLInputElement||t.preventDefault(),this.nativeDragAndDrop){var n=/version\/(\d+).+?safari/i.test(window.navigator.userAgent);e&&this.emulateNativeDragAndDropOnTouch||n||this.emulateNativeDragAndDropForAll?this.emulateNativeDragAndDrop(t):(this.element.draggable=!0,document.addEventListener(Z,this._nativeDragEnd,!!V&&{passive:!1}))}else document.addEventListener(et,this._dragMove,!!V&&{passive:!1}),document.addEventListener(Q,this._dragMove,!!V&&{passive:!1}),document.addEventListener(nt,this._dragEnd,!!V&&{passive:!1}),document.addEventListener(Z,this._dragEnd,!!V&&{passive:!1});window.addEventListener("scroll",this._scroll),this.isDragging=!0,this.emit("drag:start"),p(this.element,"dragee-active"),this.emit("drag:move")}}},{key:"stopDragging",value:function(){document.removeEventListener(et,this._dragMove),document.removeEventListener(Q,this._dragMove),document.removeEventListener(nt,this._dragEnd),document.removeEventListener(Z,this._dragEnd),document.removeEventListener("dragover",this._nativeDragOver),document.removeEventListener("dragend",this._nativeDragEnd),document.removeEventListener(Z,this._nativeDragEnd),document.removeEventListener("drop",this._nativeDrop),document.removeEventListener("drop",this._nativeDrop),window.removeEventListener("scroll",this._scroll),this.element.draggable=!1,this.isDragging=!1,y(this.element,"dragee-active")}},{key:"dragMove",value:function(t){var e;this.currentEvent=t;var n=U&&t instanceof window.TouchEvent;if(!n||(e=st(t,this._touchId))){t.stopPropagation(),t.preventDefault(),this.touchPoint=new f(n?e.pageX:t.clientX,n?e.pageY:t.clientY);var i=this._startPosition.add(this.touchPoint.sub(this._startTouchPoint)).add(this.scrollPoint.sub(this._startScrollPoint));i=this.bound(i,this.getSize()),this.move(i)}}},{key:"dragEnd",value:function(t){U&&t instanceof window.TouchEvent&&!st(t,this._touchId)||(t.stopPropagation(),t.preventDefault(),this.dragEndAction(),this.emit("drag:end"),document.removeEventListener(et,this._dragMove),document.removeEventListener(Q,this._dragMove),document.removeEventListener(nt,this._dragEnd),document.removeEventListener(Z,this._dragEnd),window.removeEventListener("scroll",this._scroll),this.isDragging=!1,this.element.removeAttribute("draggable"),y(this.element,"dragee-active"))}},{key:"onScroll",value:function(){var t=this._startPosition.add(this.touchPoint.sub(this._startTouchPoint)).add(this.scrollPoint.sub(this._startScrollPoint));t=this.bound(t,this.getSize()),this.nativeDragAndDrop||this.move(t)}},{key:"nativeDragStart",value:function(t){t.dataTransfer.setData("text","FireFox fix"),t.dataTransfer.effectAllowed="move",document.addEventListener("dragover",this._nativeDragOver),document.addEventListener("dragend",this._nativeDragEnd),document.addEventListener("drop",this._nativeDrop)}},{key:"nativeDragOver",value:function(t){if(t.preventDefault(),t.dataTransfer.dropEffect="move",p(this.element,"dragee-placeholder"),0!==(this.currentEvent=t).clientX||0!==t.clientY){this.touchPoint=new f(t.clientX,t.clientY);var e=this._startPosition.add(this.touchPoint.sub(this._startTouchPoint)).add(this.scrollPoint.sub(this._startScrollPoint));e=this.bound(e,this.getSize()),this.position=e,this.emit("drag:move")}}},{key:"nativeDragEnd",value:function(){y(this.element,"dragee-placeholder"),this.dragEndAction(),this.emit("drag:end"),document.removeEventListener("dragover",this._nativeDragOver),document.removeEventListener("dragend",this._nativeDragEnd),document.removeEventListener(Z,this._nativeDragEnd),document.removeEventListener("drop",this._nativeDrop),window.removeEventListener("scroll",this._scroll),this.isDragging=!1,this.element.removeAttribute("draggable"),y(this.element,"dragee-active")}},{key:"nativeDrop",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"emulateNativeDragAndDrop",value:function(t){var e=this,n=this.parent.getBoundingClientRect(),i=this.element.cloneNode(!0);i.style[rt]="",function t(e,n){for(var i=window.getComputedStyle(e),r=0;r<i.length;r++){var o=i[r];o.indexOf("transition")<0&&o.indexOf("transform")<0&&(n.style[o]=i[o])}for(var s=0;s<e.children.length;s++)t(e.children[s],n.children[s])}(this.element,i),i.style.position="absolute",document.body.appendChild(i),p(this.element,"dragee-placeholder");var r=new s(i,{parent:document.body,bound:function(t){return t},on:{"drag:move":function(){var t=new f(n.left,n.top);e.position=r.position.sub(t).sub(e._startScrollPoint),e.emit("drag:move")},"drag:end":function(){r.destroy(),document.body.removeChild(i),y(e.element,"dragee-placeholder"),y(e.element,"dragee-active")}}}),o=new f(n.left,n.top);r._startScrollPoint=this._startScrollPoint,r.move(this.pinnedPosition.add(o).add(new f(window.scrollX,window.scrollY))),r.dragStart(t)}},{key:"dragEndAction",value:function(){this.pinPosition(this.position)}},{key:"getRectangle",value:function(){return new v(this.position,this.getSize())}},{key:"refresh",value:function(){this.bound.refresh&&this.bound.refresh()}},{key:"destroy",value:function(){this.handler.removeEventListener(tt,this._dragStart),this.handler.removeEventListener(J,this._dragStart),this.element.removeEventListener("dragstart",this._nativeDragStart),document.removeEventListener(et,this._dragMove),document.removeEventListener(Q,this._dragMove),document.removeEventListener(nt,this._dragEnd),document.removeEventListener(Z,this._dragEnd),document.removeEventListener("dragover",this._nativeDragOver),document.removeEventListener("dragend",this._nativeDragEnd),document.removeEventListener(Z,this._nativeDragEnd),document.removeEventListener("drop",this._nativeDrop),this.resetEmitter();var t=it.indexOf(this);-1<t&&it.splice(t,1)}},{key:"parent",get:function(){return this._parent=this._parent||this.options.parent||m(this.element)}},{key:"handler",get:function(){return this._handler||("string"==typeof this.options.handler?this._handler=this.element.querySelector(this.options.handler)||this.element:this._handler=this.options.handler||this.element),this._handler}},{key:"nativeDragAndDrop",get:function(){return this.options.nativeDragAndDrop||!1}},{key:"emulateNativeDragAndDropOnTouch",get:function(){return this.options.emulateNativeDragAndDropOnTouch||!0}},{key:"emulateNativeDragAndDropForAll",get:function(){return this.options.emulateNativeDragAndDropForAll||!1}},{key:"scrollPoint",get:function(){return new f(window.scrollX,window.scrollY)}},{key:"enable",get:function(){return this._enable},set:function(t){return t?y(this.element,"dragee-disable"):p(this.element,"dragee-disable"),this._enable=t}}]),s}();at.emitter=new n(at),at.emitter.on("draggable:create",function(t){K.addDraggable(t)});var ut=function(){function r(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,r),(e=c(this,h(r).call(this,void 0,n))).options=Object.assign({timeEnd:200,timeExcange:400,radius:30},n),e.draggables=t,e.init(),e}return a(r,n),e(r,[{key:"init",value:function(){this._enable=!0,this.draggables.forEach(this.initDraggable,this)}},{key:"initDraggable",value:function(t){var e=this;t.enable=this._enable,t.on("drag:move",function(){return e.onMove(t)}),t.dragEndAction=function(){return t.pinPosition(t.pinnedPosition,e.options.timeEnd)}}},{key:"onMove",value:function(t){var e=this.getSortedDraggables(),n=e.map(function(t){return t.pinnedPosition}),i=e.indexOf(t),r=k(n,t.position,this.options.radius,this.distanceFunc);if(-1!==r&&i!==r){if(r<i)for(var o=r;o<i;o++)e[o].pinPosition(n[o+1],this.options.timeExcange);else for(var s=i;s<r;s++)e[s+1].pinPosition(n[s],this.options.timeExcange);t.nativeDragAndDrop?t.pinPosition(n[r]):t.pinnedPosition=n[r],this.emit("list:change")}}},{key:"getCurrentPinnedPositions",value:function(){return this.draggables.map(function(t){return t.pinnedPosition.clone()})}},{key:"getSortedDraggables",value:function(){return this.draggables.sort(this.sorting.bind(this))}},{key:"reset",value:function(){this.draggables.forEach(function(t){return t.resetPositionToInitial()})}},{key:"refresh",value:function(){this.draggables.forEach(function(t){return t.refresh()})}},{key:"add",value:function(t){var e=this;t instanceof Array||(t=[t]),t.forEach(function(t){return e.initDraggable(t)}),this.draggables=this.draggables.concat(t)}},{key:"remove",value:function(t){var e=this,n=this.draggables.map(function(t){return t.initialPosition}),i=[],r=this.getSortedDraggables();t instanceof Array||(t=[t]),t.forEach(function(t){t.resetOn("drag:end"),t.resetOn("drag:move"),j(e.draggables,t)});var o=0;r.forEach(function(t){-1!==e.draggables.indexOf(t)&&(t.pinnedPosition!==n[o]&&t.pinPosition(n[o],e.options.timeExcange),t.initialPosition=n[o],o++,i.push(t))}),this.draggables=i}},{key:"clear",value:function(){this.remove(this.draggables.slice())}},{key:"destroy",value:function(){this.draggables.forEach(function(t){return t.destroy()})}},{key:"sorting",value:function(t,e){return this.options.sorting?this.options.sorting(t,e):t.pinnedPosition.y<e.pinnedPosition.y?-1:t.pinnedPosition.y>e.pinnedPosition.y?1:t.pinnedPosition.x<e.pinnedPosition.x?-1:t.pinnedPosition.x>e.pinnedPosition.x?1:0}},{key:"distanceFunc",get:function(){return this.options.getDistance||w}},{key:"positions",get:function(){return this.getCurrentPinnedPositions()},set:function(t){var n=this;if(t.length!==this.draggables.length)throw"wrong array length";t.forEach(function(t,e){n.draggables[e].pinPosition(t)})}},{key:"enable",get:function(){return this._enable},set:function(e){this._enable=e,this.draggables.forEach(function(t){t.enable=e})}}],[{key:"factory",value:function(e,t,n){var i=2<arguments.length&&void 0!==n?n:{};return new r(Array.from(t).map(function(t){return new at(t,Object.assign({parent:e},i.draggable||{}))}),i.list||{})}}]),r}(),ht=function(){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return u(this,r),c(this,h(r).call(this,t,e))}return a(r,ut),e(r,[{key:"initDraggable",value:function(t){var e=this;t.on("drag:start",function(){return e.autoDetectVerticalGap(t)}),s(h(r.prototype),"initDraggable",this).call(this,t)}},{key:"autoDetectVerticalGap",value:function(){if(2<=this.draggables.length){var t=this.getSortedDraggables();this.verticalGap=t[1].pinnedPosition.y-t[0].pinnedPosition.y-t[0].getSize().y}else this.verticalGap=0;1<=this.draggables.length&&(this.startPosition=this.draggables[0].pinnedPosition)}},{key:"onMove",value:function(t){var e=this.getSortedDraggables(),n=e.map(function(t){return t.pinnedPosition}),i=e.indexOf(t),r=k(n,t.position,this.options.radius,this.distanceFunc);if(-1!==r&&i!==r){var o=[e[r],e[i]];e[i]=o[0],e[r]=o[1],this.bubling(e,t),this.emit("list:change")}}},{key:"bubling",value:function(t,n){var i=this,r=this.startPosition.clone();t.forEach(function(t,e){t.pinnedPosition.compare(r)||(t!==n||n.nativeDragAndDrop?t.pinPosition(r,t===n?0:i.options.timeExcange):t.pinnedPosition=r.clone()),r.y=r.y+t.getSize().y+i.verticalGap})}},{key:"distanceFunc",get:function(){return this.options.getDistance||P}}],[{key:"factory",value:function(e,t,n){var i=2<arguments.length&&void 0!==n?n:{};return new r(Array.from(t).map(function(t){return new at(t,Object.assign({parent:e},i.draggable||{}))}),i.list||{})}}]),r}();function lt(t,e){var n=document.createElement("canvas");return"static"===window.getComputedStyle(t).position&&(t.style.position="relative"),n.setAttribute("width",e.size.x+"px"),n.setAttribute("height",e.size.y+"px"),function(t,e){e=e||{};var n="";for(var i in e)e.hasOwnProperty(i)&&(n+=i+": "+e[i]+"; ");t.style.cssText=n}(n,{position:"absolute",left:e.position.y+"px",top:e.position.y+"px",width:e.size.x+"px",height:e.size.y+"px"}),function(t,e){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}(t,n),n}var ct=function(){function r(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};u(this,r);var i=v.fromElement(t,t);this.options=Object.assign({angle:0,dAngle:2*Math.PI/e.length,center:i.getCenter(),startRadius:50,endRadius:i.getMinSide()/2,lineWidth:2,strokeStyle:"#ff5577",fillStyle:"rgba(150,255,50,0.8)"},n),this.area=t,this.areaRectangle=i,this.init(e)}return e(r,[{key:"init",value:function(t){var s=this;this.canvas=lt(this.area,this.areaRectangle),this.context=this.canvas.getContext("2d"),this.draggables=t.map(function(t,e){var n=s.options.angle+e*s.options.dAngle,i=f.elementSize(t).mult(.5),r=M(n,s.options.startRadius,s.options.center).sub(i),o=M(n,s.options.endRadius,s.options.center).sub(i);return new at(t,{parent:s.area,bound:I.bounding(r,o),position:r,on:{"drag:move":function(){return s.draw()}}})}),this.isInit=!0,this.draw()}},{key:"draw",value:function(){if(this.isInit){this.context.clearRect(0,0,this.areaRectangle.size.x,this.areaRectangle.size.y),this.context.beginPath();var t=this.draggables[0].getCenter();this.context.moveTo(t.x,t.y);for(var e=0;e<this.draggables.length;e++)t=this.draggables[e].getCenter(),this.context.lineTo(t.x,t.y);this.context.closePath(),this.context.lineWidth=this.options.lineWidth,this.context.strokeStyle=this.options.strokeStyle,this.context.stroke(),this.context.fillStyle=this.options.fillStyle,this.context.fill()}}}]),r}(),gt=function(){function o(t,e){var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};u(this,o),n=c(this,h(o).call(this,void 0,i));var r=v.fromElement(t,t);return n.options=Object.assign({center:r.getCenter(),radius:r.getMinSide()/2,startAngle:Math.PI,endAngle:0,angles:[Math.PI,-Math.PI/4,0,Math.PI/4,Math.PI/2],time:500},i),n.shiftedCenter=n.options.center,n.area=t,n.init(e),n}return a(o,n),e(o,[{key:"init",value:function(t){var e=this,n=this.options.startAngle,i=M(n,this.options.radius,this.shiftedCenter);this.angle=n,this.draggable=new at(t,{parent:this.area,bound:N.bounding(this.shiftedCenter,this.options.radius,this.options.startAngle,this.options.endAngle),position:i,on:{"drag:move":function(){return e.change()}}})}},{key:"updateAngle",value:function(){this.angle=A(this.shiftedCenter,this.draggable.position)}},{key:"change",value:function(){this.updateAngle(),this.emit("arcslider:change",{angle:this.angle})}},{key:"setAngle",value:function(t,e){var n=M(this.angle,this.options.radius,this.shiftedCenter);this.angle=O(t),this.draggable.pinPosition(n,e||0),this.emit("arcslider:change",this.angle)}}]),o}(),dt=function(){return Math.round(255*Math.random())},ft=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e};var vt=function(){function o(t,e){var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};u(this,o),n=c(this,h(o).call(this,void 0,i));var r=v.fromElement(t,t);return n.options=Object.assign({center:r.getCenter(),radius:r.getMinSide()/2,touchRadius:r.getMinSide()/2,boundAngle:Math.PI/9,fillStyles:Y(0,e.length).map(function(){return"#".concat(ft(dt())).concat(ft(dt())).concat(ft(dt()))}),initAngles:Y(-90,270,360/e.length).map(function(t){return function(t){return t%360*Math.PI/180}(t)}),limitImg:null,limitImgOffset:new f(0,0)},i),n.area=t,n.areaRectangle=r,n.init(e),n}return a(o,n),e(o,[{key:"init",value:function(t){var o=this;this.canvas=lt(this.area,this.areaRectangle),this.context=this.canvas.getContext("2d"),this.draggables=t.map(function(t,e){var n=o.options.initAngles[e],i=f.elementSize(t).mult(.5),r=M(n,o.options.touchRadius,o.options.center.sub(i));return new at(t,{parent:o.area,bound:N.bounding(o.options.center.sub(i),o.options.touchRadius,o.getBoundAngle(e,!1),o.getBoundAngle(e,!0)),position:r,on:{"drag:move":function(){return o.draw()}}})}),this.isInit=!0,this.draw()}},{key:"updateAngles",value:function(){var n=this;this.angles=this.draggables.map(function(t){var e=t.getSize().mult(.5);return A(n.options.center.sub(e),t.position)})}},{key:"getBoundAngle",value:function(e,t){var n=this,i=t?1:-1;return function(){var t=(e+i)%n.angles.length;return t<0&&(t+=n.angles.length),O(n.angles[t]-i*n.options.boundAngle)}}},{key:"draw",value:function(){var n=this;this.isInit&&(this.updateAngles(),this.context.clearRect(0,0,this.areaRectangle.size.x,this.areaRectangle.size.y),this.draggables.forEach(function(t,e){n.drawArc(n.context,n.options.center,n.options.radius,e)}),this.draggables.forEach(function(t,e){n.drawLimitImg(e)}),this.emit("chart:draw"))}},{key:"createClone",value:function(t,e){var n=this,i=1<arguments.length&&void 0!==e?e:{};if(this.isInit){var r=v.fromElement(t,t),o=Object.assign({center:r.getCenter(),radius:r.getMinSide()/2,fillStyles:this.options.fillStyles},i),s=lt(t,r).getContext("2d"),a={draw:function(){s.clearRect(0,0,r.size.x,r.size.y),n.draggables.forEach(function(t,e){n.drawArc(s,o.center,o.radius,e)})}};return a.draw(),a}}},{key:"getFillStyle",value:function(t){return"function"==typeof this.options.fillStyles[t]&&(this.options.fillStyles[t]=this.options.fillStyles[t].call(this)),this.options.fillStyles[t]}},{key:"drawArc",value:function(t,e,n,i){var r=this.angles[i],o=this.angles[(i+1)%this.angles.length],s=this.getFillStyle(i);t.beginPath(),t.moveTo(e.x,e.y),t.arc(e.x,e.y,n,r,o,!1),t.lineTo(e.x,e.y),t.closePath(),t.fillStyle=s,t.fill()}},{key:"drawLimitImg",value:function(t){var e,n;if(this.options.limitImg&&(n=this.options.limitImg instanceof Array?this.options.limitImg[t]:this.options.limitImg),n){var i=O(this.angles[t]);e=(e=new f(0,-n.height/2)).add(this.options.limitImgOffset),this.context.translate(this.areaRectangle.size.x/2,this.areaRectangle.size.y/2),this.context.rotate(i),this.context.drawImage(n,e.x,e.y),this.context.setTransform(1,0,0,1,0,0)}}},{key:"getAnglesDiff",value:function(){var t=this.angles.slice(1),n=this.angles[0];return t.push(n),t.map(function(t){var e=O(t-n);return n=t,e})}},{key:"getPercent",value:function(){return this.getAnglesDiff().map(function(t){return t/(2*Math.PI)})}},{key:"getArcBisectrixs",value:function(){var n=this;return this.getAnglesDiff().map(function(t,e){return O(n.angles[e]+t/2)})}},{key:"getArcOnPoint",value:function(t){var e=A(this.options.center,t);if(w(this.options.center,t)>this.options.radius)return-1;var n,i,r=-1;for(n=0;n<this.angles.length;n++)(-1===r||this.angles[r]>this.angles[n])&&(r=n);for(n=0,i=r;n<this.angles.length&&!(e<this.angles[i]);i=(++n+r)%this.angles.length);return--i<0&&(i+=this.angles.length),i}},{key:"setAngles",value:function(t){var o=this;this.angles=t,this.draggables.forEach(function(t,e){var n=o.angles[e],i=t.getSize().mult(.5),r=M(n,o.options.touchRadius,o.options.center.sub(i));t.moveAndSave(r)}),this.draw()}},{key:"setActiveArc",value:function(t){var n=function(t,e){var n=[];return-1!==t&&(n.push(t),n.push((t+1)%e)),n}(t,this.draggables.length);this.activeArcIndex=t,this.draggables.forEach(function(t,e){t.enable=-1!==n.indexOf(e)}),this.draw()}}]),o}();return t.ArcSlider=gt,t.Bound=L,t.BoundToArc=N,t.BoundToCircle=B,t.BoundToElement=T,t.BoundToLine=I,t.BoundToLineX=z,t.BoundToLineY=C,t.BoundToRectangle=R,t.BubblingList=ht,t.Chart=vt,t.Draggable=at,t.FloatLeftStrategy=G,t.FloatRightStrategy=q,t.List=ut,t.NotCrossingStrategy=F,t.Point=f,t.Rectangle=v,t.Scope=W,t.Spider=ct,t.Target=H,t.addClass=p,t.defaultScope=K,t.getDistance=w,t.getXDifference=function(t,e){return Math.abs(t.x-e.x)},t.getYDifference=P,t.indexOfNearestPoint=k,t.removeClass=y,t.scope=function(t){function e(t){i.addDraggable(t),at.emitter.interrupt()}function n(t){i.addTarget(t),at.emitter.interrupt()}var i=new W;return at.emitter.prependOn("draggable:create",e),H.emitter.prependOn("target:create",n),t.call(),at.emitter.unsubscribe("draggable:create",e),H.emitter.unsubscribe("target:create",n),i},t.scopes=$,t.transformedSpaceDistanceFactory=E,t}({});
